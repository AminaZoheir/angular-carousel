/*
 * angular-carousel.js - v1.0.0 - 2014-01-30
 * Copyright (c) 2014 Lifely
 * All right reserved
 *
 *
 *
 **/
angular.module("angular-carousel",[]).factory("Carousel",function(){var n={}
n.instances={},n.add=function(t,i,r){if(i=i||!1,!i)return"Error: no carousel name specified"
t=t||0
var a=n.instances[i]||!1
if(a)return"Error: carousel instance already exists"
var o=new e(t,r)
return n.instances[i]=o,o},n.get=function(e){var t=n.instances[e]||!1
return t?t:"Error: carousel with name '"+e+"' does not exist"}
var e=function(n,e){var t=this
this.slidesCount=n,this.currentSlide=0,this.onSlideChangeCallbacks=[],this.toIndex=function(n,i){i=i||!1,this.currentSlide=n%this.slidesCount,angular.forEach(this.onSlideChangeCallbacks,function(n){"function"==typeof n&&n(t.currentSlide,i)}),e.$$phase||e.$apply()},this.next=function(){var n=this.currentSlide+1,e=!1
return n>this.slidesCount-1&&(n=0,e="right"),this.toIndex(n,e),n},this.previous=function(){var n=this.currentSlide-1,e=!1
return 0>n&&(n=this.slidesCount-1,e="left"),this.toIndex(n,e),n},this.onSlideChange=function(n){return this.onSlideChangeCallbacks.push(n),this.onSlideChangeCallbacks.indexOf(n)},this.unbindOnSlideChangeCallback=function(n){void 0!==this.onSlideChangeCallbacks[n]&&this.onSlideChangeCallbacks.splice(n,1)}}
return n}).directive("ngCarousel",["Carousel","$compile","$document","$timeout",function(n,e,t,i){function r(){return"ontouchstart"in document.documentElement}var a=25
return{restrict:"AE",link:function(o,s,u){s.addClass("ng-carousel"),s.addClass(r()?"touch":"no-touch")
var l=s.find("slide"),c=n.add(l.length,u.ngCarouselName,o),d=s.find("slidecontainer"),h=e(l[0].outerHTML)(o),f=e(l[l.length-1].outerHTML)(o)
d.append(h),d.prepend(f),d.addClass("carousel-ignore-first-slide")
var m=!1,C=!1,g=!1
m=void 0!==u.ngCarouselTimer&&parseInt(u.ngCarouselTimer,10)>0?parseInt(u.ngCarouselTimer,10):!1,g=void 0!==u.ngCarouselRandom
var v=function(){m&&(C&&i.cancel(C),C=i(function(){c.next()},m))},p=function(n,e,t){e?d.addClass("carousel-animate"):d.removeClass("carousel-animate")
var i="translate(-"+100*n+"%, 0)"
d.css({"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i}),e&&d.bind("transitionend oTransitionEnd webkitTransitionEnd",function(){"function"==typeof t&&t(),d.unbind("transitionend oTransitionEnd webkitTransitionEnd"),p(c.currentSlide+1,!1)})}
c.onSlideChange(function(n,e){var t=n+1
"left"===e?t=0:"right"===e&&(t=l.length+1),p(t,!0,function(){"left"===e?p(l.length,!1):"right"===e&&p(1,!1)}),v()})
var S=0,b=0,k=function(n){S=n/b,S=S>1?1:-1>S?-1:S,p(c.currentSlide+1-S,!1)},E=function(){b=d[0].offsetWidth},T=function(){Math.abs(S)>a/100?(S>0?c.previous():c.next(),S=0):(S>0||0>S)&&p(c.currentSlide+1,!0,function(){S=0})},x=new Hammer.Manager(d[0])
x.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL,threshold:0})),x.on("panleft panright",function(n){n.isFinal||k(n.deltaX)})
var I=r()?"touchstart":"mousedown",w=r()?"touchend":"mouseup"
if(t.on(I,E),t.on(w,T),g){var H=Math.floor(Math.random()*c.slidesCount)
c.toIndex(H)}m&&v(),s.on("mouseover",function(){C&&i.cancel(C)}),s.on("mouseout",v)}}}])
